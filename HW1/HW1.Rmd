---
title: "STAT416 Assignment 1"
author: "Ashish Jain"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    echo = TRUE,
    message = FALSE,
    warning = FALSE
)
```

#Question 1:

i). The treatment factors considered in the experiment is Nitrogen.

ii). The treatment level considered in the experiment for Nitrogen is high and low.

iii). No, this is not a full factorial experimental design.

iv). The experimental units in this experiment is pots and genotype. There are 12 pots and 2 genotypes.

v). The observational units is the seedling.

vi). Yes this experimental involves blocking. The block is the seedling.

vii). It is a randomized incomplete block design. This is due to the fact that first the blocks are created on the basis of genotype and after that first the high nitrogen treated pots are selected which created bias in the selection and making it ranomized incomplete.

#Question 2:

There are different sources of variabilty in this experiment.

##i). Biological Variabilty

##ii). Technical Variabilty

##iii). Treatment Effect


#Question 3:
$$H_0: \ p_1 = p_2 \ vs \ H_1:p_1 \neq p_2$$

where,$p_1$ is the probability of drawing reads for gene g in the first lane and $p_2$ is the probability of drawing reads for gene g in the second lane.
```{r, tidy=TRUE, tidy.opts=list(width.cutoff=60)}
library("tidyverse")
table<-data.frame(Lane=c("Gene g count","Total read Count"),"1"=c("50","10M"),"2"=c("25","8M"))
table %>% knitr::kable(caption = "Number of Reads")

FisherTestMatrix <-
 matrix(c(50, 1e7,25,8e6),
        nrow = 2,
        dimnames = list(gene = c("yes", "no"),
                       lane = c("1", "2")))
fisher.test(FisherTestMatrix)
```

As, seen from the Fisher's exact test the P-Value is 0.06245 which is greater than 0.05, so we cannot reject the null hypothesis with 95% confidence and hence there is no evidence for lane effect in terms of mapping rate.

#Question 4:

i). 

ii).

iii).

iv).

v).

vi).



#Question 5:

i).
The Hyopthesis test is:

$$H_0: T.S. \ \sim \ \chi^2_{J-1} \ VS \ H_1: T.S. \ \nsim \ \chi^2_{J-1}$$

where, 
$$T.S. = \sum \frac{{Y_{gj}-C_j \hat{\mu_g}}^2}{C_j\hat{\mu_g}}$$
$J-1$ is the number of independent observations â€“ the number of estimated parameters, $j$ is the lane number, \^{\mu_g} is the estimated mean.


```{r, tidy=TRUE, tidy.opts=list(width.cutoff=60)}
library("tidyverse")
library("MASS")
path<-"https://raw.githubusercontent.com/ashishjain1988/STAT416/master/HW1/"
countData<-read.table(paste0(path,"hwk1_4.csv"),header = TRUE,sep = ",")
mean.countData<-apply(as.matrix(countData),1,mean)
qqnorm(mean.countData)

chitestlist <- apply(as.matrix(countData),1,chisq.test)
chitest.pval <- sapply(chitestlist, '[[', 'p.value')
plot(chitest.pval)
ks.test(chitest.pval,"punif",0,1)
```


